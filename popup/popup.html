<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BenchmarkBox</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="bb-header">
      <div class="bb-header-left">
        <div class="bb-logo">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <rect x="2" y="3" width="20" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
            <path d="M8 7h8M8 11h8M8 15h5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <h1 class="bb-title">BenchmarkBox</h1>
      </div>
      <div class="bb-header-actions">
        <button id="btn-settings" class="bb-icon-btn" title="Paramètres">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
        </button>
        <button id="btn-add-product" class="bb-add-product-btn" title="Ajouter le produit actuel">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          Ajouter
        </button>
      </div>
    </header>

    <!-- Search & Filters Bar -->
    <div class="bb-search-bar">
      <div class="bb-search-input-wrapper">
        <svg class="bb-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="M21 21l-4.35-4.35"/>
        </svg>
        <input type="text" id="search-input" class="bb-search-input" placeholder="Rechercher...">
      </div>
      <button id="btn-filters" class="bb-btn bb-btn-ghost bb-btn-sm">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
        </svg>
        Filtres
      </button>
    </div>

    <!-- Filters Panel (hidden by default) -->
    <div id="filters-panel" class="bb-filters-panel bb-hidden">
      <div class="bb-filter-group">
        <label>Tags</label>
        <div id="filter-tags" class="bb-tag-select"></div>
      </div>
      <div class="bb-filter-group">
        <label>Site</label>
        <select id="filter-site" class="bb-select">
          <option value="">Tous les sites</option>
        </select>
      </div>
      <div class="bb-filter-row">
        <div class="bb-filter-group">
          <label>Prix min</label>
          <input type="number" id="filter-price-min" class="bb-input bb-input-sm" placeholder="0">
        </div>
        <div class="bb-filter-group">
          <label>Prix max</label>
          <input type="number" id="filter-price-max" class="bb-input bb-input-sm" placeholder="∞">
        </div>
      </div>
      <div class="bb-filter-actions">
        <button id="btn-clear-filters" class="bb-btn bb-btn-ghost bb-btn-sm">Effacer</button>
        <button id="btn-apply-filters" class="bb-btn bb-btn-primary bb-btn-sm">Appliquer</button>
      </div>
    </div>

    <!-- Tabs Navigation -->
    <div class="bb-tabs">
      <button id="tab-folders" class="bb-tab bb-tab-active" data-tab="folders">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
        </svg>
        Dossiers
      </button>
      <button id="tab-shopping" class="bb-tab" data-tab="shopping">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="9" cy="21" r="1"/>
          <circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
        </svg>
        Achats
      </button>
    </div>

    <!-- Main Content -->
    <main class="bb-main">
      <!-- TAB: Folders (Benchmark) -->
      <div id="tab-content-folders" class="bb-tab-content bb-tab-content-active">
        <!-- Folders List - Vertical compact list -->
        <section class="bb-section bb-folders-section">
          <div class="bb-folders-header">
            <span class="bb-folders-title">Dossiers</span>
            <button id="btn-add-folder" class="bb-folders-add-btn" title="Nouveau dossier">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
            </button>
          </div>
          <div id="folders-list" class="bb-folders-list">
            <!-- Folders will be rendered here -->
          </div>
        </section>

        <!-- Products Section - Takes ALL remaining space -->
        <section class="bb-section bb-products-section">
          <div class="bb-products-header">
            <span id="products-folder-name" class="bb-products-title">Tous les produits</span>
            <div class="bb-products-actions">
              <button id="btn-open-all-folder-links" class="bb-btn-open-all bb-hidden" title="Ouvrir tous les liens">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                  <polyline points="15 3 21 3 21 9"/>
                  <line x1="10" y1="14" x2="21" y2="3"/>
                </svg>
              </button>
              <button id="btn-clear-folder" class="bb-icon-btn bb-icon-btn-sm bb-hidden" title="Vider le dossier">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6"/>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
              </button>
              <select id="sort-select" class="bb-select bb-select-sm">
                <option value="date-desc">Plus récent</option>
                <option value="date-asc">Plus ancien</option>
                <option value="price-asc">Prix ↑</option>
                <option value="price-desc">Prix ↓</option>
                <option value="name-asc">Nom A-Z</option>
                <option value="name-desc">Nom Z-A</option>
              </select>
            </div>
          </div>
          <div id="products-list" class="bb-products-list">
            <!-- Products will be rendered here -->
          </div>
          <div id="products-empty" class="bb-empty-state bb-hidden">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.5">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            </svg>
            <p>Aucun produit</p>
            <span class="bb-empty-hint">Cliquez sur + pour ajouter un produit</span>
          </div>
        </section>
      </div>

      <!-- TAB: Shopping Lists -->
      <div id="tab-content-shopping" class="bb-tab-content">
        <!-- Shopping Lists Overview -->
        <section id="shopping-lists-section" class="bb-section">
          <div class="bb-section-header">
            <h2 class="bb-section-title">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="9" cy="21" r="1"/>
                <circle cx="20" cy="21" r="1"/>
                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
              </svg>
              Listes d'achats
            </h2>
            <button id="btn-add-shopping-list" class="bb-icon-btn bb-icon-btn-sm" title="Nouvelle liste">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
            </button>
          </div>
          <div id="shopping-lists" class="bb-shopping-lists">
            <!-- Shopping lists will be rendered here -->
          </div>
          <div id="shopping-lists-empty" class="bb-empty-state bb-hidden">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.5">
              <circle cx="9" cy="21" r="1"/>
              <circle cx="20" cy="21" r="1"/>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
            </svg>
            <p>Aucune liste d'achats</p>
            <span class="bb-empty-hint">Créez une liste pour planifier vos achats</span>
          </div>
        </section>

        <!-- Shopping List Detail View (hidden by default) -->
        <section id="shopping-list-detail" class="bb-section bb-hidden">
          <div class="bb-section-header bb-section-header-back">
            <button id="btn-back-to-lists" class="bb-icon-btn bb-icon-btn-sm" title="Retour">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
              </svg>
            </button>
            <h2 id="shopping-list-detail-name" class="bb-section-title">Liste</h2>
            <div class="bb-section-actions">
              <button id="btn-clear-shopping-list" class="bb-icon-btn bb-icon-btn-sm" title="Vider la liste">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6"/>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
              </button>
              <button id="btn-edit-shopping-list" class="bb-icon-btn bb-icon-btn-sm" title="Modifier">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
              </button>
            </div>
          </div>
          
          <!-- Budget Summary -->
          <div id="shopping-list-budget-summary" class="bb-budget-summary-section">
            <div class="bb-budget-date">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <line x1="16" y1="2" x2="16" y2="6"/>
                <line x1="8" y1="2" x2="8" y2="6"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
              </svg>
              <span id="shopping-list-planned-date">Pas de date</span>
            </div>
            <div class="bb-budget-card">
              <div class="bb-budget-row">
                <span class="bb-budget-label">Budget max</span>
                <span id="shopping-list-budget-max" class="bb-budget-value">-</span>
              </div>
              <div class="bb-budget-row">
                <span class="bb-budget-label">Total</span>
                <span id="shopping-list-total" class="bb-budget-value bb-budget-total">0,00€</span>
              </div>
              <div class="bb-budget-row">
                <span class="bb-budget-label">Restant</span>
                <span id="shopping-list-remaining" class="bb-budget-value bb-budget-remaining">-</span>
              </div>
              <div class="bb-budget-bar-wrapper">
                <div id="shopping-list-bar" class="bb-budget-bar">
                  <div id="shopping-list-bar-fill" class="bb-budget-bar-fill" style="width: 0%"></div>
                </div>
                <span id="shopping-list-percentage" class="bb-budget-percentage">0%</span>
              </div>
              <div id="shopping-list-currency-warning" class="bb-currency-warning bb-hidden">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                  <line x1="12" y1="9" x2="12" y2="13"/>
                  <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
                <span>Devises mixtes - totaux approximatifs</span>
              </div>
            </div>
          </div>
          
          <!-- Products in List -->
          <div class="bb-shopping-list-products-header">
            <span id="shopping-list-product-count">0 produits</span>
            <button id="btn-open-all-list-links" class="bb-btn-open-all" title="Ouvrir tous les liens">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                <polyline points="15 3 21 3 21 9"/>
                <line x1="10" y1="14" x2="21" y2="3"/>
              </svg>
              Tout ouvrir
            </button>
          </div>
          </div>
          <div id="shopping-list-products" class="bb-products-list">
            <!-- Products will be rendered here -->
          </div>
          <div id="shopping-list-products-empty" class="bb-empty-state bb-hidden">
            <p>Aucun produit dans cette liste</p>
            <span class="bb-empty-hint">Ajoutez des produits depuis l'onglet Dossiers</span>
          </div>
        </section>
      </div>
    </main>

    <!-- Add/Edit Product Modal -->
    <div id="modal-product" class="bb-modal-overlay bb-hidden">
      <div class="bb-modal bb-modal-lg">
        <div class="bb-modal-header">
          <h3 id="modal-product-title">Ajouter un produit</h3>
          <button class="bb-modal-close" data-close-modal>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <form id="form-product" class="bb-modal-body">
          <input type="hidden" id="product-id">
          
          <div class="bb-form-group">
            <label for="product-name">Nom du produit *</label>
            <input type="text" id="product-name" class="bb-input" required placeholder="Ex: MacBook Air M3">
          </div>
          
          <div class="bb-form-row">
            <div class="bb-form-group bb-form-group-grow">
              <label for="product-price">Prix *</label>
              <input type="number" id="product-price" class="bb-input" required step="0.01" min="0" placeholder="0.00">
            </div>
            <div class="bb-form-group">
              <label for="product-currency">Devise</label>
              <select id="product-currency" class="bb-select">
                <option value="EUR">€ EUR</option>
                <option value="USD">$ USD</option>
                <option value="GBP">£ GBP</option>
              </select>
            </div>
          </div>
          
          <div class="bb-form-group">
            <label for="product-url">URL</label>
            <input type="url" id="product-url" class="bb-input" placeholder="https://...">
          </div>
          
          <div class="bb-form-group">
            <label for="product-folder">Dossier</label>
            <select id="product-folder" class="bb-select">
              <!-- Folders will be populated -->
            </select>
          </div>
          
          <div class="bb-form-group">
            <label>Tags</label>
            <div id="product-tags" class="bb-tags-input">
              <div id="product-tags-selected" class="bb-tags-selected"></div>
              <input type="text" id="product-tag-input" class="bb-tag-input" placeholder="Ajouter un tag...">
            </div>
            <div id="product-tags-suggestions" class="bb-tags-suggestions bb-hidden"></div>
          </div>
          
          <div class="bb-form-group">
            <label for="product-notes">Notes</label>
            <textarea id="product-notes" class="bb-textarea" rows="2" placeholder="Remarques, livraison, promo..."></textarea>
          </div>
        </form>
        <div class="bb-modal-footer">
          <button type="button" class="bb-btn bb-btn-ghost" data-close-modal>Annuler</button>
          <button type="submit" form="form-product" class="bb-btn bb-btn-primary">Enregistrer</button>
        </div>
      </div>
    </div>

    <!-- Add/Edit Folder Modal -->
    <div id="modal-folder" class="bb-modal-overlay bb-hidden">
      <div class="bb-modal">
        <div class="bb-modal-header">
          <h3 id="modal-folder-title">Nouveau dossier</h3>
          <button class="bb-modal-close" data-close-modal>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <form id="form-folder" class="bb-modal-body">
          <input type="hidden" id="folder-id">
          
          <div class="bb-form-group">
            <label for="folder-name">Nom *</label>
            <input type="text" id="folder-name" class="bb-input" required placeholder="Ex: PC Portable">
          </div>
          
          <div class="bb-form-group">
            <label for="folder-color">Couleur</label>
            <div class="bb-color-picker">
              <input type="color" id="folder-color" value="#f97316">
              <div class="bb-color-presets">
                <button type="button" class="bb-color-preset" data-color="#f97316" style="background:#f97316"></button>
                <button type="button" class="bb-color-preset" data-color="#ef4444" style="background:#ef4444"></button>
                <button type="button" class="bb-color-preset" data-color="#f59e0b" style="background:#f59e0b"></button>
                <button type="button" class="bb-color-preset" data-color="#10b981" style="background:#10b981"></button>
                <button type="button" class="bb-color-preset" data-color="#3b82f6" style="background:#3b82f6"></button>
                <button type="button" class="bb-color-preset" data-color="#8b5cf6" style="background:#8b5cf6"></button>
                <button type="button" class="bb-color-preset" data-color="#ec4899" style="background:#ec4899"></button>
                <button type="button" class="bb-color-preset" data-color="#6b7280" style="background:#6b7280"></button>
              </div>
            </div>
          </div>
          
          <div class="bb-form-group">
            <label for="folder-description">Description</label>
            <input type="text" id="folder-description" class="bb-input" placeholder="Optionnel">
          </div>
          
          <div class="bb-form-group">
            <label class="bb-checkbox-label">
              <input type="checkbox" id="folder-default">
              <span>Définir comme dossier par défaut</span>
            </label>
          </div>
        </form>
        <div class="bb-modal-footer">
          <button type="button" class="bb-btn bb-btn-ghost" data-close-modal>Annuler</button>
          <button type="submit" form="form-folder" class="bb-btn bb-btn-primary">Enregistrer</button>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div id="modal-settings" class="bb-modal-overlay bb-hidden">
      <div class="bb-modal">
        <div class="bb-modal-header">
          <h3>Paramètres</h3>
          <button class="bb-modal-close" data-close-modal>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <div class="bb-modal-body">
          <!-- Tags Management -->
          <div class="bb-settings-section">
            <h4>Gestion des tags</h4>
            <div id="settings-tags-list" class="bb-settings-tags"></div>
            <div class="bb-settings-tag-add">
              <input type="text" id="settings-new-tag" class="bb-input bb-input-sm" placeholder="Nouveau tag">
              <input type="color" id="settings-new-tag-color" value="#f97316">
              <button id="btn-add-tag" class="bb-btn bb-btn-primary bb-btn-sm">Ajouter</button>
            </div>
          </div>
          
          <!-- Data Management -->
          <div class="bb-settings-section">
            <h4>Données</h4>
            <div class="bb-settings-actions">
              <button id="btn-export" class="bb-btn bb-btn-ghost">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Exporter
              </button>
              <button id="btn-import" class="bb-btn bb-btn-ghost">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="17 8 12 3 7 8"/>
                  <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
                Importer
              </button>
              <input type="file" id="import-file" accept=".json" class="bb-hidden">
            </div>
          </div>
          
          <!-- Danger Zone -->
          <div class="bb-settings-section bb-settings-danger">
            <h4>Zone de danger</h4>
            <button id="btn-reset" class="bb-btn bb-btn-danger">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
              </svg>
              Réinitialiser toutes les données
            </button>
          </div>
        </div>
        <div class="bb-modal-footer">
          <button type="button" class="bb-btn bb-btn-primary" data-close-modal>Fermer</button>
        </div>
      </div>
    </div>

    <!-- Product Context Menu -->
    <div id="context-menu" class="bb-context-menu bb-hidden">
      <button data-action="open" class="bb-context-item">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
          <polyline points="15 3 21 3 21 9"/>
          <line x1="10" y1="14" x2="21" y2="3"/>
        </svg>
        Ouvrir le lien
      </button>
      <button data-action="edit" class="bb-context-item">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
        </svg>
        Modifier
      </button>
      <button data-action="move" class="bb-context-item">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
        </svg>
        Déplacer vers...
      </button>
      <button data-action="duplicate" class="bb-context-item">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
        </svg>
        Dupliquer dans...
      </button>
      <div class="bb-context-divider"></div>
      <button data-action="delete" class="bb-context-item bb-context-item-danger">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3 6 5 6 21 6"/>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        </svg>
        Supprimer
      </button>
    </div>

    <!-- Move/Duplicate Modal -->
    <div id="modal-move" class="bb-modal-overlay bb-hidden">
      <div class="bb-modal bb-modal-sm">
        <div class="bb-modal-header">
          <h3 id="modal-move-title">Déplacer vers</h3>
          <button class="bb-modal-close" data-close-modal>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <div class="bb-modal-body">
          <input type="hidden" id="move-product-id">
          <input type="hidden" id="move-action">
          <div id="move-folders-list" class="bb-move-folders"></div>
        </div>
      </div>
    </div>

    <!-- Add/Edit Shopping List Modal -->
    <div id="modal-shopping-list" class="bb-modal-overlay bb-hidden">
      <div class="bb-modal">
        <div class="bb-modal-header">
          <h3 id="modal-shopping-list-title">Nouvelle liste d'achats</h3>
          <button class="bb-modal-close" data-close-modal>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <form id="form-shopping-list" class="bb-modal-body">
          <input type="hidden" id="shopping-list-id">
          
          <div class="bb-form-group">
            <label for="shopping-list-name">Nom *</label>
            <input type="text" id="shopping-list-name" class="bb-input" required placeholder="Ex: Setup Gaming">
          </div>
          
          <div class="bb-form-row">
            <div class="bb-form-group bb-form-group-grow">
              <label for="shopping-list-budget">Budget maximum</label>
              <input type="number" id="shopping-list-budget" class="bb-input" step="0.01" min="0" placeholder="Optionnel">
            </div>
            <div class="bb-form-group">
              <label for="shopping-list-currency">Devise</label>
              <select id="shopping-list-currency" class="bb-select">
                <option value="EUR">€ EUR</option>
                <option value="USD">$ USD</option>
                <option value="GBP">£ GBP</option>
              </select>
            </div>
          </div>
          
          <div class="bb-form-group">
            <label>Date d'achat prévue</label>
            <div class="bb-radio-group">
              <label class="bb-radio-label">
                <input type="radio" name="planned-date-type" value="none" checked>
                <span>Pas de date</span>
              </label>
              <label class="bb-radio-label">
                <input type="radio" name="planned-date-type" value="this_week">
                <span>Cette semaine</span>
              </label>
              <label class="bb-radio-label">
                <input type="radio" name="planned-date-type" value="next_week">
                <span>Semaine prochaine</span>
              </label>
              <label class="bb-radio-label">
                <input type="radio" name="planned-date-type" value="this_month">
                <span>Ce mois-ci</span>
              </label>
              <label class="bb-radio-label">
                <input type="radio" name="planned-date-type" value="next_month">
                <span>Mois prochain</span>
              </label>
              <label class="bb-radio-label">
                <input type="radio" name="planned-date-type" value="custom">
                <span>Date précise</span>
              </label>
            </div>
            <input type="date" id="shopping-list-custom-date" class="bb-input bb-hidden">
          </div>
        </form>
        <div class="bb-modal-footer">
          <button type="button" class="bb-btn bb-btn-ghost" data-close-modal>Annuler</button>
          <button type="submit" form="form-shopping-list" class="bb-btn bb-btn-primary">Enregistrer</button>
        </div>
      </div>
    </div>

    <!-- Add to Shopping List Modal -->
    <div id="modal-add-to-list" class="bb-modal-overlay bb-hidden">
      <div class="bb-modal">
        <div class="bb-modal-header">
          <h3>Ajouter aux listes d'achats</h3>
          <button class="bb-modal-close" data-close-modal>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <div class="bb-modal-body">
          <input type="hidden" id="add-to-list-product-id">
          <div id="add-to-list-lists" class="bb-shopping-lists-select">
            <!-- Lists will be rendered here -->
          </div>
          <button id="btn-create-list-from-modal" class="bb-btn bb-btn-ghost bb-btn-full">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Créer nouvelle liste
          </button>
        </div>
        <div class="bb-modal-footer">
          <button type="button" class="bb-btn bb-btn-ghost" data-close-modal>Annuler</button>
          <button id="btn-confirm-add-to-list" class="bb-btn bb-btn-primary">Confirmer</button>
        </div>
      </div>
    </div>
  </div>

  <script src="../lib/storage.js"></script>
  <script src="../lib/utils.js"></script>
  <script src="popup.js"></script>
</body>
</html>
